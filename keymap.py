key_map = {
    0: 'reserved',
    1: 'esc',
    2: '1',
    3: '2',
    4: '3',
    5: '4',
    6: '5',
    7: '6',
    8: '7',
    9: '8',
    10: '9',
    11: '0',
    12: 'minus',
    13: 'equal',
    14: 'backspace',
    15: 'tab',
    16: 'q',
    17: 'w',
    18: 'e',
    19: 'r',
    20: 't',
    21: 'y',
    22: 'u',
    23: 'i',
    24: 'o',
    25: 'p',
    26: 'leftbrace',
    27: 'rightbrace',
    28: 'enter',
    29: 'ctrlleft',
    30: 'a',
    31: 's',
    32: 'd',
    33: 'f',
    34: 'g',
    35: 'h',
    36: 'j',
    37: 'k',
    38: 'l',
    39: 'semicolon',
    40: 'apostrophe',
    41: 'grave',
    42: 'shiftleft',
    43: 'backslash',
    44: 'z',
    45: 'x',
    46: 'c',
    47: 'v',
    48: 'b',
    49: 'n',
    50: 'm',
    51: 'comma',
    52: 'dot',
    53: 'slash',
    54: 'shiftright',
    55: 'asterisk',
    56: 'altleft',
    57: 'space',
    58: 'capslock',
    59: 'f1',
    60: 'f2',
    61: 'f3',
    62: 'f4',
    63: 'f5',
    64: 'f6',
    65: 'f7',
    66: 'f8',
    67: 'f9',
    68: 'f10',
    69: 'numlock',
    70: 'scrolllock',
    71: 'numpad7',
    72: 'numpad8',
    73: 'numpad9',
    74: 'subtract',
    75: 'numpad4',
    76: 'numpad5',
    77: 'numpad6',
    78: 'add',
    79: 'numpad1',
    80: 'numpad2',
    81: 'numpad3',
    82: 'numpad0',
    83: 'decimal',
    85: 'zenkakuhankaku',
    86: '102nd',
    87: 'f11',
    88: 'f12',
    89: 'ro',
    90: 'katakana',
    91: 'hiragana',
    92: 'henkan',
    93: 'katakanahiragana',
    94: 'muhenkan',
    95: 'jpcomma',
    96: 'enter',
    97: 'ctrlright',
    98: 'divide',
    99: 'sysrq',
    100: 'altright',
    101: 'linefeed',
    102: 'home',
    103: 'up',
    104: 'pageup',
    105: 'left',
    106: 'right',
    107: 'end',
    108: 'down',
    109: 'pagedown',
    110: 'insert',
    111: 'delete',
    112: 'macro',
    113: 'mute',
    114: 'volumedown',
    115: 'volumeup',
    116: 'power',
    117: 'equals',
    118: 'plusminus',
    119: 'pause',
    120: 'scale',
    121: 'comma',
    122: 'hangeul',
    123: 'hanja',
    124: 'yen',
    125: 'metaleft',
    126: 'metaright',
    127: 'compose',
    128: 'stop',
    129: 'again',
    130: 'props',
    131: 'undo',
    132: 'front',
    133: 'copy',
    134: 'open',
    135: 'paste',
    136: 'find',
    137: 'cut',
    138: 'help',
    139: 'menu',
    140: 'calculator',
    141: 'setup',
    142: 'sleep',
    143: 'wakeup',
    144: 'file',
    145: 'sendfile',
    146: 'deletefile',
    147: 'xfer',
    148: 'prog1',
    149: 'prog2',
    150: 'www',
    151: 'msdos',
    152: 'coffee',
    153: 'screenlock',
    154: 'rotate_display',
    155: 'direction',
    156: 'cyclewindows',
    157: 'mail',
    158: 'bookmarks',
    159: 'computer',
    160: 'back',
    161: 'forward',
    162: 'closecd',
    163: 'ejectcd',
    164: 'ejectclosecd',
    165: 'nexttrack',
    166: 'playpause',
    167: 'prevtrack',
    168: 'stopcd',
    169: 'record',
    170: 'rewind',
    171: 'phone',
    172: 'iso',
    173: 'config',
    174: 'homepage',
    175: 'refresh',
    176: 'exit',
    177: 'move',
    178: 'edit',
    179: 'scrollup',
    180: 'scrolldown',
    181: 'leftparen',
    182: 'rightparen',
    183: 'new',
    184: 'redo',
    185: 'f13',
    186: 'f14',
    187: 'f15',
    188: 'f16',
    189: 'f17',
    190: 'f18',
    191: 'f19',
    192: 'f20',
    193: 'f21',
    194: 'f22',
    195: 'f23',
    196: 'f24',
    197: 'playcd',
    198: 'pausecd',
    199: 'prog3',
    200: 'prog4',
    201: 'dashboard',
    202: 'suspend',
    203: 'close',
    204: 'play',
    205: 'fastforward',
    206: 'bassboost',
    207: 'print',
    208: 'hp',
    209: 'camera',
    210: 'sound',
    211: 'question',
    212: 'email',
    213: 'chat',
    214: 'search',
    215: 'connect',
    216: 'finance',
    217: 'sport',
    218: 'shop',
    219: 'alterase',
    220: 'cancel',
    221: 'brightnessdown',
    222: 'brightnessup',
    223: 'media',
    224: 'switchvideomode',
    225: 'kbdillumtoggle',
    226: 'kbdillumdown',
    227: 'kbdillumup',
    228: 'send',
    229: 'reply',
    230: 'forwardmail',
    231: 'save',
    232: 'documents',
    233: 'battery',
    234: 'bluetooth',
    235: 'wlan',
    236: 'uwb',
    237: 'unknown',
    238: 'nextvideo',
    239: 'prevvideo',
    240: 'brightnesscycle',
    241: 'brightnessauto',
    242: 'displayoff',
    243: 'wwan',
    244: 'rfkill',
    245: 'micmute'
}


win32map = {
    0: 0x00,  # reserved
    1: 0x1B,  # VK_ESCAPE
    2: 0x31,  # '1'
    3: 0x32,  # '2'
    4: 0x33,  # '3'
    5: 0x34,  # '4'
    6: 0x35,  # '5'
    7: 0x36,  # '6'
    8: 0x37,  # '7'
    9: 0x38,  # '8'
    10: 0x39,  # '9'
    11: 0x30,  # '0'
    12: 0xBD,  # VK_OEM_MINUS (minus)
    13: 0xBB,  # VK_OEM_PLUS (equal)
    14: 0x08,  # VK_BACK (backspace)
    15: 0x09,  # VK_TAB (tab)
    16: 0x51,  # 'Q'
    17: 0x57,  # 'W'
    18: 0x45,  # 'E'
    19: 0x52,  # 'R'
    20: 0x54,  # 'T'
    21: 0x59,  # 'Y'
    22: 0x55,  # 'U'
    23: 0x49,  # 'I'
    24: 0x4F,  # 'O'
    25: 0x50,  # 'P'
    26: 0xDB,  # VK_OEM_4 (leftbrace)
    27: 0xDD,  # VK_OEM_6 (rightbrace)
    28: 0x0D,  # VK_RETURN (enter)
    29: 0xA2,  # VK_LCONTROL (ctrlleft)
    30: 0x41,  # 'A'
    31: 0x53,  # 'S'
    32: 0x44,  # 'D'
    33: 0x46,  # 'F'
    34: 0x47,  # 'G'
    35: 0x48,  # 'H'
    36: 0x4A,  # 'J'
    37: 0x4B,  # 'K'
    38: 0x4C,  # 'L'
    39: 0xBA,  # VK_OEM_1 (semicolon)
    40: 0xDE,  # VK_OEM_7 (apostrophe)
    41: 0xC0,  # VK_OEM_3 (grave)
    42: 0xA0,  # VK_LSHIFT (shiftleft)
    43: 0xDC,  # VK_OEM_5 (backslash)
    44: 0x5A,  # 'Z'
    45: 0x58,  # 'X'
    46: 0x43,  # 'C'
    47: 0x56,  # 'V'
    48: 0x42,  # 'B'
    49: 0x4E,  # 'N'
    50: 0x4D,  # 'M'
    51: 0xBC,  # VK_OEM_COMMA (comma)
    52: 0xBE,  # VK_OEM_PERIOD (dot)
    53: 0xBF,  # VK_OEM_2 (slash)
    54: 0xA1,  # VK_RSHIFT (shiftright)
    55: 0x6A,  # VK_MULTIPLY (asterisk)
    56: 0xA4,  # VK_LMENU (altleft)
    57: 0x20,  # VK_SPACE (space)
    58: 0x14,  # VK_CAPITAL (capslock)
    59: 0x70,  # VK_F1
    60: 0x71,  # VK_F2
    61: 0x72,  # VK_F3
    62: 0x73,  # VK_F4
    63: 0x74,  # VK_F5
    64: 0x75,  # VK_F6
    65: 0x76,  # VK_F7
    66: 0x77,  # VK_F8
    67: 0x78,  # VK_F9
    68: 0x79,  # VK_F10
    69: 0x90,  # VK_NUMLOCK (numlock)
    70: 0x91,  # VK_SCROLL (scrolllock)
    71: 0x67,  # VK_NUMPAD7 (numpad7)
    72: 0x68,  # VK_NUMPAD8 (numpad8)
    73: 0x69,  # VK_NUMPAD9 (numpad9)
    74: 0x6D,  # VK_SUBTRACT (subtract)
    75: 0x64,  # VK_NUMPAD4 (numpad4)
    76: 0x65,  # VK_NUMPAD5 (numpad5)
    77: 0x66,  # VK_NUMPAD6 (numpad6)
    78: 0x6B,  # VK_ADD (add)
    79: 0x61,  # VK_NUMPAD1 (numpad1)
    80: 0x62,  # VK_NUMPAD2 (numpad2)
    81: 0x63,  # VK_NUMPAD3 (numpad3)
    82: 0x60,  # VK_NUMPAD0 (numpad0)
    83: 0x6E,  # VK_DECIMAL (decimal)
    85: 0x0C,  # VK_OEM_PA1 (zenkakuhankaku)
    86: 0xE2,  # VK_OEM_102 (102nd)
    87: 0x7A,  # VK_F11
    88: 0x7B,  # VK_F12
    89: 0x93,  # VK_RO (katakana)
    90: 0x92,  # VK_KANA (hiragana)
    91: 0x1C,  # VK_CONVERT (henkan)
    92: 0x1D,  # VK_NONCONVERT (katakanahiragana)
    93: 0x7F,  # VK_APPS (muhenkan)
    94: 0xBF,  # VK_OEM_COMMA (jpcomma)
    96: 0x0D,  # VK_RETURN (enter)
    97: 0xA3,  # VK_RCONTROL (ctrlright)
    98: 0x6F,  # VK_DIVIDE (divide)
    99: 0x2C,  # VK_SNAPSHOT (sysrq)
    100: 0xA5,  # VK_RMENU (altright)
    101: 0x0A,  # VK_OEM_4 (linefeed)
    102: 0x24,  # VK_HOME (home)
    103: 0x26,  # VK_UP (up)
    104: 0x21,  # VK_PRIOR (pageup)
    105: 0x25,  # VK_LEFT (left)
    106: 0x27,  # VK_RIGHT (right)
    107: 0x23,  # VK_END (end)
    108: 0x28,  # VK_DOWN (down)
    109: 0x22,  # VK_NEXT (pagedown)
    110: 0x2D,  # VK_INSERT (insert)
    111: 0x2E,  # VK_DELETE (delete)
    112: 0x88,  # VK_OEM_8 (macro)
    113: 0xAD,  # VK_VOLUME_MUTE (mute)
    114: 0xAE,  # VK_VOLUME_DOWN (volumedown)
    115: 0xAF,  # VK_VOLUME_UP (volumeup)
    116: 0x81,  # VK_OEM_CLEAR (clear)
    117: 0x0D,  # VK_RETURN (enter)
    118: 0xB1,  # VK_OEM_PLUS (plusminus)
    119: 0x13,  # VK_PAUSE (pause)
    120: 0x7E,  # VK_OEM_PA2 (scale)
    121: 0xBC,  # VK_OEM_COMMA (comma)
    122: 0x15,  # VK_KANJI (hangeul)
    123: 0x19,  # VK_HANJA (hanja)
    124: 0x5D,  # VK_OEM_5 (yen)
    125: 0x5B,  # VK_LWIN (metaleft)
    126: 0x5C,  # VK_RWIN (metaright)
    127: 0xFF,  # VK_OEM_ATTN (compose)
    128: 0xFF,  # VK_OEM_FINISH (stop)
    129: 0xFF,  # VK_OEM_COPY (again)
    130: 0xFF,  # VK_OEM_AUTO (props)
    131: 0xFF,  # VK_OEM_ENLW (undo)
    132: 0xFF,  # VK_OEM_BACKTAB (front)
    133: 0xFF,  # VK_ATTN (copy)
    134: 0xFF,  # VK_CRSEL (open)
    135: 0xFF,  # VK_EXSEL (paste)
    136: 0xFF,  # VK_EREOF (find)
    137: 0xFF,  # VK_PLAY (cut)
    138: 0xFF,  # VK_ZOOM (help)
    139: 0xFF,  # VK_NONAME (menu)
    140: 0xFF,  # VK_PA1 (calculator)
    141: 0xFF,  # VK_OEM_CLEAR (setup)
    142: 0xFF,  # VK_SLEEP (sleep)
    143: 0xFF,  # VK_WAKE (wakeup)
    144: 0xFF,  # VK_FILE (file)
    145: 0xFF,  # VK_RETURN (sendfile)
    146: 0xFF,  # VK_RETURN (deletefile)
    147: 0xFF,  # VK_EXECUTE (xfer)
    148: 0xFF,  # VK_HELP (prog1)
    149: 0xFF,  # VK_MENU (prog2)
    150: 0xFF,  # VK_SELECT (www)
    151: 0xFF,  # VK_PRINT (msdos)
    152: 0xFF,  # VK_EXECUTE (coffee)
    153: 0xFF,  # VK_INSERT (screenlock)
    154: 0xFF,  # VK_CLEAR (rotate_display)
    155: 0xFF,  # VK_PAUSE (direction)
    156: 0xFF,  # VK_HELP (cyclewindows)
    157: 0xFF,  # VK_SELECT (mail)
    158: 0xFF,  # VK_BROWSER_BOOKMARKS (bookmarks)
    159: 0xFF,  # VK_LAUNCH_APP1 (computer)
    160: 0xFF,  # VK_BROWSER_BACK (back)
    161: 0xFF,  # VK_BROWSER_FORWARD (forward)
    162: 0xFF,  # VK_MEDIA_EJECT (closecd)
    163: 0xFF,  # VK_MEDIA_EJECT (ejectcd)
    164: 0xFF,  # VK_MEDIA_EJECT (ejectclosecd)
    165: 0xFF,  # VK_MEDIA_NEXT_TRACK (nexttrack)
    166: 0xFF,  # VK_MEDIA_PLAY_PAUSE (playpause)
    167: 0xFF,  # VK_MEDIA_PREV_TRACK (prevtrack)
    168: 0xFF,  # VK_MEDIA_STOP (stopcd)
    169: 0xFF,  # VK_MEDIA_RECORD (record)
    170: 0xFF,  # VK_MEDIA_REWIND (rewind)
    171: 0xFF,  # VK_PHONE (phone)
    172: 0xFF,  # VK_ICO_00 (iso)
    173: 0xFF,  # VK_ICO_CONFIG (config)
    174: 0xFF,  # VK_BROWSER_HOME (homepage)
    175: 0xFF,  # VK_BROWSER_REFRESH (refresh)
    176: 0xFF,  # VK_BROWSER_STOP (exit)
    177: 0xFF,  # VK_BROWSER_SEARCH (move)
    178: 0xFF,  # VK_BROWSER_FAVORITES (edit)
    179: 0xFF,  # VK_BROWSER_FORWARD (scrollup)
    180: 0xFF,  # VK_BROWSER_BACK (scrolldown)
    181: 0xFF,  # VK_OEM_5 (leftparen)
    182: 0xFF,  # VK_OEM_6 (rightparen)
    183: 0xFF,  # VK_BROWSER_FAVORITES (new)
    184: 0xFF,  # VK_BROWSER_REFRESH (redo)
    185: 0xFF,  # VK_F13
    186: 0xFF,  # VK_F14
    187: 0xFF,  # VK_F15
    188: 0xFF,  # VK_F16
    189: 0xFF,  # VK_F17
    190: 0xFF,  # VK_F18
    191: 0xFF,  # VK_F19
    192: 0xFF,  # VK_F20
    193: 0xFF,  # VK_F21
    194: 0xFF,  # VK_F22
    195: 0xFF,  # VK_F23
    196: 0xFF,  # VK_F24
    197: 0xFF,  # VK_MEDIA_PLAY (playcd)
    198: 0xFF,  # VK_MEDIA_PAUSE (pausecd)
    199: 0xFF,  # VK_HELP (prog3)
    200: 0xFF,  # VK_HELP (prog4)
    201: 0xFF,  # VK_LAUNCH_APP2 (dashboard)
    202: 0xFF,  # VK_CANCEL (suspend)
    203: 0xFF,  # VK_CLOSE (close)
    204: 0xFF,  # VK_MEDIA_PLAY (play)
    205: 0xFF,  # VK_MEDIA_FAST_FORWARD (fastforward)
    206: 0xFF,  # VK_MEDIA_PLAY_PAUSE (bassboost)
    207: 0xFF,  # VK_PRINT (print)
    208: 0xFF,  # VK_LAUNCH_HP (hp)
    209: 0xFF,  # VK_CAMERA (camera)
    210: 0xFF,  # VK_MEDIA_PLAY_PAUSE (sound)
    211: 0xFF,  # VK_OEM_QUESTION (question)
    212: 0xFF,  # VK_LAUNCH_MAIL (email)
    213: 0xFF,  # VK_LAUNCH_APP1 (chat)
    214: 0xFF,  # VK_BROWSER_SEARCH (search)
    215: 0xFF,  # VK_LAUNCH_CONNECTIONS (connect)
    216: 0xFF,  # VK_LAUNCH_INTERNET_BROWSER (finance)
    217: 0xFF,  # VK_LAUNCH_INTERNET_BROWSER (sport)
    218: 0xFF,  # VK_LAUNCH_INTERNET_BROWSER (shop)
    219: 0xFF,  # VK_OEM_5 (alterase)
    220: 0xFF,  # VK_CANCEL (cancel)
    221: 0xFF,  # VK_BRIGHTNESS_DOWN (brightnessdown)
    222: 0xFF,  # VK_BRIGHTNESS_UP (brightnessup)
    223: 0xFF,  # VK_MEDIA_AUDIO_TRACK (media)
    224: 0xFF,  # VK_SWITCH_VT_1 (switchvideomode)
    225: 0xFF,  # VK_OEM_19 (kbdillumtoggle)
    226: 0xFF,  # VK_OEM_20 (kbdillumdown)
    227: 0xFF,  # VK_OEM_21 (kbdillumup)
    228: 0xFF,  # VK_SEND (send)
    229: 0xFF,  # VK_PACKET (reply)
    230: 0xFF,  # VK_OEM_FORWARD (forwardmail)
    231: 0xFF,  # VK_OEM_ATTN (save)
    232: 0xFF,  # VK_OEM_FINISH (documents)
    233: 0xFF,  # VK_BATTERY_LOW (battery)
    234: 0xFF,  # VK_BATTERY_HIGH (bluetooth)
    235: 0xFF,  # VK_WLAN (wlan)
    236: 0xFF,  # VK_UWB (uwb)
    237: 0xFF,  # VK_UNKNOWN (unknown)
    238: 0xFF,  # VK_MEDIA_NEXT_TRACK (nextvideo)
    239: 0xFF,  # VK_MEDIA_PREV_TRACK (prevvideo)
    240: 0xFF,  # VK_BRIGHTNESS_CYCLE (brightnesscycle)
    241: 0xFF,  # VK_BRIGHTNESS_AUTO (brightnessauto)
    242: 0xFF,  # VK_DISPLAY_OFF (displayoff)
    243: 0xFF,  # VK_WWAN (wwan)
    244: 0xFF,  # VK_OEM_22 (rfkill)
    245: 0xFF,  # VK_VOLUME_MUTE (micmute)
}

extended_keys = {
    74: 0x6D,  # VK_SUBTRACT (subtract)
    78: 0x6B,  # VK_ADD (add)
    85: 0x0C,  # VK_OEM_PA1 (zenkakuhankaku)
    86: 0xE2,  # VK_OEM_102 (102nd)
    87: 0x7A,  # VK_F11
    88: 0x7B,  # VK_F12
    89: 0x93,  # VK_RO (katakana)
    90: 0x92,  # VK_KANA (hiragana)
    91: 0x1C,  # VK_CONVERT (henkan)
    92: 0x1D,  # VK_NONCONVERT (katakanahiragana)
    93: 0x7F,  # VK_APPS (muhenkan)
    94: 0xBF,  # VK_OEM_COMMA (jpcomma)
    98: 0x6F,  # VK_DIVIDE (divide)
    99: 0x2C,  # VK_SNAPSHOT (sysrq)
    100: 0xA5,  # VK_RMENU (altright)
    101: 0x0A,  # VK_OEM_4 (linefeed)
    102: 0x24,  # VK_HOME (home)
    103: 0x26,  # VK_UP (up)
    104: 0x21,  # VK_PRIOR (pageup)
    105: 0x25,  # VK_LEFT (left)
    106: 0x27,  # VK_RIGHT (right)
    107: 0x23,  # VK_END (end)
    108: 0x28,  # VK_DOWN (down)
    109: 0x22,  # VK_NEXT (pagedown)
    110: 0x2D,  # VK_INSERT (insert)
    111: 0x2E,  # VK_DELETE (delete)
    112: 0x88,  # VK_OEM_8 (macro)
    113: 0xAD,  # VK_VOLUME_MUTE (mute)
    114: 0xAE,  # VK_VOLUME_DOWN (volumedown)
    115: 0xAF,  # VK_VOLUME_UP (volumeup)
    116: 0x81,  # VK_OEM_CLEAR (clear)
    118: 0xB1,  # VK_OEM_PLUS (plusminus)
    120: 0x7E,  # VK_OEM_PA2 (scale)
    121: 0xBC,  # VK_OEM_COMMA (comma)
    122: 0x15,  # VK_KANJI (hangeul)
    123: 0x19,  # VK_HANJA (hanja)
    124: 0x5D,  # VK_OEM_5 (yen)
    125: 0x5B,  # VK_LWIN (metaleft)
    126: 0x5C,  # VK_RWIN (metaright)
    127: 0xFF,  # VK_OEM_ATTN (compose)
    128: 0xFF,  # VK_OEM_FINISH (stop)
    129: 0xFF,  # VK_OEM_COPY (again)
    130: 0xFF,  # VK_OEM_AUTO (props)
    131: 0xFF,  # VK_OEM_ENLW (undo)
    132: 0xFF,  # VK_OEM_BACKTAB (front)
    133: 0xFF,  # VK_ATTN (copy)
    134: 0xFF,  # VK_CRSEL (open)
    135: 0xFF,  # VK_EXSEL (paste)
    136: 0xFF,  # VK_EREOF (find)
    137: 0xFF,  # VK_PLAY (cut)
    138: 0xFF,  # VK_ZOOM (help)
    139: 0xFF,  # VK_NONAME (menu)
    140: 0xFF,  # VK_PA1 (calculator)
}
